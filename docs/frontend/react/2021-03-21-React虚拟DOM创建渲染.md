---
title: "React虚拟DOM创建渲染（粗略）"
date: 2021-03-21
sidebar: 'auto'
categories:
- FrontEnd
tags:
- React
---


# React 虚拟 DOM 创建及渲染

> 本文涉及 `React` 的虚拟 `DOM` 创建及渲染的部分简化逻辑，只体现其思想，并不是完全的源码。

## 虚拟 DOM 的结构

一个名为 Test 的组件实例结构如图所示

![](https://my-blog-leo.oss-cn-chengdu.aliyuncs.com/React%E6%BA%90%E7%A0%81%E8%99%9A%E6%8B%9FDOM%E5%88%9B%E5%BB%BA%E6%B8%B2%E6%9F%93.png)

这里我们只涉及 `props` 的 以及标识组件类型的 `type` 属性。

```js
{
  	props:{/**/},
    type: /**/
}
```
<!-- more -->

首先是 `React.createElement(type, config, ...children)` 函数，他接收多个参数如下表，它负责将组件的描述对象的值拷贝到 `props` 上。

| 参数          | 描述                                                         |
| ------------- | ------------------------------------------------------------ |
| `type`        | 该虚拟DOM 的类型，可能的值有普通的html标签值，还有 React 函数组件、类组件。 |
| `config`      | 该虚拟DOM 的描述对象，该对象可以有 `className`、`style` 等属性，其余的可随意传。 |
| `...children` | 该虚拟DOM 的子组件。                                         |

`assemble` 函数将 `type` 和 `props` 整合成一个对象用来描述 DOM。

`Component` 组件为 `React` 组件的父组件，该组件提供 `isReactComponent` 静态属性，标识它是一个类组件。


实现代码如下：

<RecoDemo :collapse="true">
  <template slot="code- react.js">
    <<< @/docs/frontend/react/code/xuniDOM/react.js
  </template>
  <template slot="code- react-dom.js">
    <<< @/docs/frontend/react/code/xuniDOM/react-dom.js
  </template>
  <template slot="code- index.js">
    <<< @/docs/frontend/react/code/xuniDOM/index.js
  </template>
</RecoDemo>

